**Phase 5.2 性能测试报告**

- **测试概览**: 目标服务为本地 API（`http://localhost:9999`），测试脚本包含对 `GET /api/smoke`、`POST /api/test` 与 `GET /health` 的并发请求验证。测试命令：`k6 run --vus 10 --duration 30s --out json=api-performance-final.json`。
- **测试产物**: 原始 k6 JSON 结果已保存为 `performance/results/api-performance-final.json`。

**关键指标**

- **总请求数**: 1,322,961
- **失败率**: 0.00%（`http_req_failed`）
- **平均响应时间**: ~0.196 ms
- **P95 响应时间**: ~0.381 ms
- **最大响应时间**: 43.97 ms
- **吞吐量 (RPS)**: ~44,096.9 req/s
- **数据量**: 接收约 536 MB，发送约 144 MB
- **Checks**: 3,527,896 次断言，全部通过

**阈值校验**

- `http_req_duration` (p95 < 200ms): 通过（p95 = 0.381 ms）
- `http_req_failed` (rate < 0.05): 通过（rate = 0.00%）

**结论**

- 在本次 10 VUs × 30s 的负载下，被测服务表现非常稳定：响应延迟极低、无请求失败，所有业务断言均通过，且吞吐量较高。

**建议与后续测试计划**

- 在生产或更贴近真实流量场景前，建议执行以下项目：
  - **延长时长**：运行 5–10 分钟或更长的稳定性测试（soak），观察内存/连接泄露与长期抖动。
  - **逐步加压**：按照阶梯式 VU（例如 10 → 50 → 200）确认服务在更高并发下的退化曲线与瓶颈点。
  - **资源监控联动**：在测试同时采集目标主机的 CPU、内存、连接数、GC/线程等指标，联合分析延迟与资源使用峰值。
  - **分布式/网络延迟**：如需验证真实用户体验，请在不同网络（内网/外网/跨区域）或使用分布式负载器上复现测试。
  - **异常与错误注入**：在预发布环境对下游依赖（DB、缓存）做故障注入，观察系统降级与超时策略表现。

**产物位置**

- 原始结果（k6 JSON）: `performance/results/api-performance-final.json`
- 本文档: `docs/PHASE5.2_PERFORMANCE_REPORT.md`

**下一步选项**

- 若需要，我可以：
  - 生成一份包含图表（响应时间分布、RPS、错误率）的 HTML 报告；
  - 基于 `performance/results/api-performance-final.json` 提取时间序列并绘制 PNG 图表；
  - 按照建议执行更长或更大规模的压力测试（需要确认目标与监控接入）。

**备注**

- 本次测试在本机环境执行，测试结果依赖于被测主机的当前资源与网络条件；在不同环境下（如 CI、云 staging、K8s 集群）结果可能有明显差异。

---

报告生成时间: 2025-11-27
