# 🚀 问题诊断与故障排查工具系统 - 完整使用指南

## 📋 系统概览

**问题诊断与故障排查工具系统** 是一个全面的系统诊断和问题排查工具包，专为项目开发、测试和运维环境设计。

### 🎯 核心特性

- ✅ **多维度诊断**: 系统资源、应用状态、性能、安全等全方位检查
- ✅ **交互式界面**: 用户友好的命令行交互式诊断工具
- ✅ **快速检查**: 快速系统健康状态检查和故障检测
- ✅ **详细报告**: 自动生成诊断报告和历史记录
- ✅ **灵活配置**: 支持配置文件和环境变量自定义
- ✅ **全局命令**: 项目级别的诊断命令，一键启动
- ✅ **中文界面**: 完全中文化界面和输出

### 🏗️ 系统架构

```
problems_and_diagnostics/
├── 📁 scripts/                 # 诊断脚本核心
│   ├── system-diagnosis.js     # 系统诊断引擎
│   ├── log-analyzer.js         # 日志分析器
│   └── interactive-diagnostics.js # 交互式诊断工具
├── 📁 configs/                 # 配置文件
│   └── config.json             # 诊断配置
├── 📁 reports/                 # 报告目录
├── diagnose.sh                # 主启动脚本
├── setup-diagnostics.sh       # 环境设置脚本
├── package.json               # 依赖管理
├── README.md                  # 详细文档
├── .env                       # 环境变量配置
├── .bash_aliases             # 快捷别名配置
└── bin/diagnose              # 全局启动命令
```

## 🚀 快速开始

### 1. 立即使用

```bash
# 在项目根目录快速检查
./bin/diagnose --quick

# 完整系统诊断
./bin/diagnose --full

# 交互式诊断（推荐）
./bin/diagnose
```

### 2. 安装快捷别名

```bash
# 一次性设置
cd problems_and_diagnostics
source .bash_aliases

# 然后在任何位置使用
diagnose --quick
diag-full
```

## 📖 详细使用方法

### 🎯 命令行选项

| 选项 | 描述 | 示例 |
|------|------|------|
| `-h, --help` | 显示帮助信息 | `./bin/diagnose --help` |
| `-i, --interactive` | 启动交互式诊断 | `./bin/diagnose` |
| `-q, --quick` | 快速系统检查 | `./bin/diagnose --quick` |
| `-f, --full` | 完整系统诊断 | `./bin/diagnose --full` |
| `-e, --errors` | 分析错误日志 | `./bin/diagnose --errors` |
| `-p, --performance` | 性能检查 | `./bin/diagnose --performance` |
| `-s, --security` | 安全扫描 | `./bin/diagnose --security` |
| `-r, --report` | 查看历史报告 | `./bin/diagnose --report` |
| `-c, --config` | 编辑配置文件 | `./bin/diagnose --config` |
| `--health-check` | 系统健康检查 | `./bin/diagnose --health-check` |

### 🔍 诊断功能详解

#### 1. 快速检查 (`--quick`)

```bash
./bin/diagnose --quick
```

- 检查磁盘空间、内存使用
- 验证关键文件是否存在
- 检查Node.js进程状态
- 生成简要状态报告

#### 2. 完整诊断 (`--full`)

```bash
./bin/diagnose --full
```

- 执行所有诊断模块
- 生成详细报告
- 包含所有检查项和建议

#### 3. 错误分析 (`--errors`)

```bash
./bin/diagnose --errors
```

- 扫描和解析日志文件
- 识别错误模式和趋势
- 生成错误统计报告

#### 4. 性能检查 (`--performance`)

```bash
./bin/diagnose --performance
```

- 监控CPU和内存使用
- 检查应用响应时间
- 生成性能分析报告

#### 5. 安全扫描 (`--security`)

```bash
./bin/diagnose --security
```

- 检查文件权限
- 验证环境变量安全
- 扫描潜在安全风险

#### 6. 交互式诊断 (`--interactive`)

```bash
./bin/diagnose
```

- 用户友好的菜单界面
- 逐步引导诊断流程
- 实时显示进度和结果

## 📊 报告生成

### 自动报告

- 每次诊断自动生成JSON格式报告
- 存储在 `reports/` 目录
- 包含时间戳和详细结果

### 历史报告查看

```bash
# 查看最新报告
./bin/diagnose --report

# 查看特定报告
ls reports/
cat reports/diagnosis-YYYYMMDD-HHMMSS.json
```

## ⚙️ 配置管理

### 环境变量配置

文件: `problems_and_diagnostics/.env`

```env
# 项目路径
PROJECT_ROOT="/Users/yanyu/yyc3-admin-system-2"
DIAGNOSTICS_DIR="problems_and_diagnostics"

# 日志配置
LOG_LEVEL="info"
LOG_FILE="reports/diagnostics.log"

# 报告配置
REPORTS_DIR="reports"
MAX_REPORTS=10

# 性能配置
QUICK_CHECK_TIMEOUT=300000
FULL_DIAGNOSIS_TIMEOUT=900000
```

### 诊断配置

文件: `problems_and_diagnostics/configs/config.json`

```json
{
  "quickCheck": {
    "diskSpaceThreshold": 90,
    "memoryThreshold": 85,
    "checkNodeJs": true
  },
  "fullDiagnosis": {
    "includeSecurityScan": true,
    "includePerformanceAnalysis": true,
    "generateDetailedReport": true
  }
}
```

## 🛠️ 高级功能

### 1. 自定义诊断脚本

在 `scripts/` 目录添加自定义JavaScript脚本：

```javascript
// scripts/custom-diagnosis.js
class CustomDiagnosis {
  async check() {
    // 自定义检查逻辑
    return { status: 'ok', message: '自定义检查完成' };
  }
}

module.exports = CustomDiagnosis;
```

### 2. 集成到CI/CD

```yaml
# .github/workflows/diagnosis.yml
name: System Diagnosis
on: [push, pull_request]
jobs:
  diagnose:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run System Diagnosis
        run: |
          cd problems_and_diagnostics
          npm install
          ./diagnose.sh --full
```

### 3. 定期健康检查

```bash
# 添加到crontab
0 */6 * * * /Users/yanyu/yyc3-admin-system-2/bin/diagnose --health-check --report
```

## 🎯 最佳实践

### 1. 日常使用流程

```bash
# 开发前检查
./bin/diagnose --quick

# 问题排查
./bin/diagnose --interactive

# 发布前完整检查
./bin/diagnose --full
```

### 2. 故障排查指南

1. **快速定位**: 使用 `--quick` 检查基本信息
2. **深入分析**: 使用 `--full` 获取详细报告
3. **专项检查**: 根据问题类型使用对应选项
4. **查看报告**: 使用 `--report` 查看历史记录

### 3. 团队协作

- 将 `problems_and_diagnostics` 纳入版本控制
- 团队成员统一使用诊断工具
- 定期查看和清理诊断报告

## 🔧 故障排除

### 常见问题

1. **权限问题**

   ```bash
   chmod +x diagnose.sh
   chmod +x bin/diagnose
   ```

2. **依赖缺失**

   ```bash
   cd problems_and_diagnostics
   npm install
   ```

3. **配置错误**

   ```bash
   ./bin/diagnose --config
   ```

### 错误排查

```bash
# 查看详细错误
./diagnose.sh --full 2>&1 | tee diagnosis-debug.log

# 验证安装
./setup-diagnostics.sh
```

## 📈 使用统计

### 诊断报告指标

- **系统健康度**: 0-100分评分
- **问题数量**: 发现的问题统计
- **建议数量**: 优化建议统计
- **执行时间**: 诊断耗时记录

### 性能监控

- CPU使用率趋势
- 内存使用模式
- 磁盘空间变化
- 网络连接状态

## 🎉 总结

问题诊断与故障排查工具系统为项目提供了：

- 🛡️ **全面的系统监控**
- 🚀 **快速的故障检测**
- 📊 **详细的诊断报告**
- 🎯 **友好的交互体验**
- ⚙️ **灵活的配置选项**

**🌹 保持代码健康，稳步前行！**

---

### 📞 支持与维护

- 📁 **文档**: 查看 `README.md` 获取详细文档
- 🔧 **配置**: 编辑 `configs/config.json` 自定义设置
- 📊 **报告**: 查看 `reports/` 目录的历史报告
- 🛠️ **脚本**: 在 `scripts/` 目录扩展功能

### 🚀 快速链接

```bash
# 一键诊断
cd problems_and_diagnostics && ./diagnose.sh

# 全局使用
./bin/diagnose --quick

# 查看帮助
./bin/diagnose --help
```

**立即开始使用，守护您的系统健康！**
